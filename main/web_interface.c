#include "web_interface.h"

// ç½‘é¡µç•Œé¢HTMLå†…å®¹
static const char* web_page_html = 
"<!DOCTYPE html>"
"<html><head>"
"<meta charset='UTF-8'>"
"<meta name='viewport' content='width=device-width, initial-scale=1.0'>"
"<title>ç”µæœºå¤šæ¨¡å¼æ§åˆ¶</title>"
"<style>"
"body{font-family:Arial,sans-serif;max-width:700px;margin:30px auto;padding:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}"
".container{background:white;padding:30px;border-radius:15px;box-shadow:0 8px 32px rgba(0,0,0,0.3)}"
"h1{color:#333;text-align:center;margin-bottom:30px;font-size:28px}"
".mode-section{margin-bottom:25px;padding:20px;border:2px solid #e0e0e0;border-radius:10px;background:#f9f9f9}"
".mode-title{font-size:18px;font-weight:bold;color:#333;margin-bottom:15px;display:flex;align-items:center}"
".mode-title:before{content:'â—';color:#4CAF50;margin-right:8px;font-size:20px}"
".form-group{margin-bottom:15px;display:flex;align-items:center;gap:10px}"
"label{min-width:100px;font-weight:bold;color:#555}"
"input[type='number'],select{padding:8px 12px;border:2px solid #ddd;border-radius:5px;font-size:14px;flex:1}"
"input[type='number']:focus,select:focus{border-color:#4CAF50;outline:none}"
"input[type='radio']{margin-right:8px}"
".radio-group{display:flex;gap:20px;margin-bottom:20px;justify-content:center}"
".radio-option{display:flex;align-items:center;padding:10px 15px;border:2px solid #ddd;border-radius:8px;cursor:pointer;transition:all 0.3s}"
".radio-option:hover{background:#f0f0f0}"
".radio-option.active{border-color:#4CAF50;background:#e8f5e8}"
".btn{background:#4CAF50;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:14px;margin:3px;transition:all 0.3s}"
".btn:hover{background:#45a049;transform:translateY(-1px)}"
".btn-danger{background:#f44336}"
".btn-danger:hover{background:#d32f2f}"
".btn-warning{background:#ff9800}"
".btn-warning:hover{background:#f57c00}"
".btn-info{background:#2196F3}"
".btn-info:hover{background:#1976D2}"
".control-panel{display:flex;justify-content:center;gap:10px;margin:20px 0;flex-wrap:wrap}"
".status{margin-top:20px;padding:15px;border-radius:8px;background:#e3f2fd;border-left:4px solid #2196F3}"
".mode-content{display:none}"
".mode-content.active{display:block}"
".unit{color:#888;font-size:12px;margin-left:5px}"
"</style>"
"</head><body>"
"<div class='container'>"
"<h1>âš™ï¸ ç”µæœºå¤šæ¨¡å¼æ§åˆ¶ç³»ç»Ÿ</h1>"

"<div class='radio-group'>"
"<div class='radio-option active' onclick='selectMode(\"velocity\")'>"
"<input type='radio' name='mode' value='velocity' checked id='mode-velocity'>"
"<label for='mode-velocity'>ğŸƒ é€Ÿåº¦æ¨¡å¼</label>"
"</div>"
"<div class='radio-option' onclick='selectMode(\"position\")'>"
"<input type='radio' name='mode' value='position' id='mode-position'>"
"<label for='mode-position'>ğŸ“ ä½ç½®æ¨¡å¼</label>"
"</div>"
"<div class='radio-option' onclick='selectMode(\"torque\")'>"
"<input type='radio' name='mode' value='torque' id='mode-torque'>"
"<label for='mode-torque'>ğŸ’ª åŠ›çŸ©æ¨¡å¼</label>"
"</div>"
"</div>"

"<div id='velocity-content' class='mode-content active'>"
"<div class='mode-section'>"
"<div class='mode-title'>é€Ÿåº¦æ§åˆ¶</div>"
"<div class='form-group'>"
"<label>ç›®æ ‡é€Ÿåº¦:</label>"
"<input type='number' id='velocity' step='0.1' placeholder='è¯·è¾“å…¥é€Ÿåº¦å€¼'>"
"<span class='unit'>r/s</span>"
"<button class='btn' onclick='setVelocity()'>è®¾ç½®é€Ÿåº¦</button>"
"</div>"
"</div>"
"</div>"

"<div id='position-content' class='mode-content'>"
"<div class='mode-section'>"
"<div class='mode-title'>ä½ç½®æ§åˆ¶</div>"
"<div class='form-group'>"
"<label>ç›®æ ‡ä½ç½®:</label>"
"<input type='number' id='position' step='0.1' placeholder='è¯·è¾“å…¥ä½ç½®å€¼'>"
"<span class='unit'>ä½ç½®å€¼</span>"
"<button class='btn' onclick='setPosition()'>è®¾ç½®ä½ç½®</button>"
"</div>"
"<div class='form-group'>"
"<label>è§’åº¦è¾“å…¥:</label>"
"<input type='number' id='angle' step='0.1' placeholder='è¯·è¾“å…¥è§’åº¦å€¼'>"
"<span class='unit'>åº¦</span>"
"<button class='btn' onclick='setAngle()'>è®¾ç½®è§’åº¦</button>"
"</div>"
"</div>"
"</div>"

"<div id='torque-content' class='mode-content'>"
"<div class='mode-section'>"
"<div class='mode-title'>åŠ›çŸ©æ§åˆ¶</div>"
"<div class='form-group'>"
"<label>ç›®æ ‡åŠ›çŸ©:</label>"
"<input type='number' id='torque' step='0.01' placeholder='è¯·è¾“å…¥åŠ›çŸ©å€¼'>"
"<span class='unit'>Nm</span>"
"<button class='btn' onclick='setTorque()'>è®¾ç½®åŠ›çŸ©</button>"
"</div>"
"</div>"
"</div>"

"<div class='control-panel'>"
"<button class='btn btn-info' onclick='enableMotor()'>ğŸ”‹ ä½¿èƒ½ç”µæœº</button>"
"<button class='btn btn-danger' onclick='disableMotor()'>ğŸ”Œ å¤±èƒ½ç”µæœº</button>"
"<button class='btn btn-warning' onclick='clearErrors()'>ğŸ”§ æ¸…é™¤é”™è¯¯</button>"
"</div>"

"<div class='status'>"
"<strong>å½“å‰çŠ¶æ€:</strong> <span id='status'>ç³»ç»Ÿå°±ç»ªï¼Œè¯·é€‰æ‹©å·¥ä½œæ¨¡å¼</span>"
"</div>"
"</div>"

"<script>"
"let currentMode='velocity';"
"function selectMode(mode){"
"currentMode=mode;"
"document.querySelectorAll('.mode-content').forEach(el=>el.classList.remove('active'));"
"document.querySelectorAll('.radio-option').forEach(el=>el.classList.remove('active'));"
"document.getElementById(mode+'-content').classList.add('active');"
"event.currentTarget.classList.add('active');"
"document.getElementById('mode-'+mode).checked=true;"
"fetch('/set_mode?mode='+mode).then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='æ¨¡å¼åˆ‡æ¢: '+getModeName(mode)+' | '+d;"
"}).catch(e=>console.log('æ¨¡å¼åˆ‡æ¢å¤±è´¥: '+e));"
"}"
"function getModeName(mode){"
"const names={'velocity':'é€Ÿåº¦æ¨¡å¼','position':'ä½ç½®æ¨¡å¼','torque':'åŠ›çŸ©æ¨¡å¼'};"
"return names[mode]||mode;"
"}"
"function setVelocity(){"
"let vel=document.getElementById('velocity').value;"
"if(vel===''){alert('è¯·è¾“å…¥é€Ÿåº¦å€¼');return;}"
"fetch('/set_velocity?value='+vel).then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='é€Ÿåº¦è®¾ç½®: '+vel+' r/s | '+d;"
"}).catch(e=>alert('è®¾ç½®å¤±è´¥: '+e));"
"}"
"function setPosition(){"
"let pos=document.getElementById('position').value;"
"if(pos===''){alert('è¯·è¾“å…¥ä½ç½®å€¼');return;}"
"fetch('/set_position?value='+pos).then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='ä½ç½®è®¾ç½®: '+pos+' | '+d;"
"}).catch(e=>alert('è®¾ç½®å¤±è´¥: '+e));"
"}"
"function setAngle(){"
"let angle=document.getElementById('angle').value;"
"if(angle===''){alert('è¯·è¾“å…¥è§’åº¦å€¼');return;}"
"fetch('/set_angle?value='+angle).then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='è§’åº¦è®¾ç½®: '+angle+'Â° | '+d;"
"}).catch(e=>alert('è®¾ç½®å¤±è´¥: '+e));"
"}"
"function setTorque(){"
"let torque=document.getElementById('torque').value;"
"if(torque===''){alert('è¯·è¾“å…¥åŠ›çŸ©å€¼');return;}"
"fetch('/set_torque?value='+torque).then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='åŠ›çŸ©è®¾ç½®: '+torque+' Nm | '+d;"
"}).catch(e=>alert('è®¾ç½®å¤±è´¥: '+e));"
"}"
"function enableMotor(){"
"fetch('/enable').then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='ç”µæœºå·²ä½¿èƒ½ | '+d;"
"}).catch(e=>alert('æ“ä½œå¤±è´¥: '+e));"
"}"
"function disableMotor(){"
"fetch('/disable').then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='ç”µæœºå·²å¤±èƒ½ | '+d;"
"}).catch(e=>alert('æ“ä½œå¤±è´¥: '+e));"
"}"
"function clearErrors(){"
"fetch('/clear').then(r=>r.text()).then(d=>{"
"document.getElementById('status').textContent='é”™è¯¯å·²æ¸…é™¤ | '+d;"
"}).catch(e=>alert('æ“ä½œå¤±è´¥: '+e));"
"}"
"</script>"
"</body></html>";

// è°ƒè¯•é¡µé¢HTMLå†…å®¹
static const char* debug_page_html = 
"<!DOCTYPE html>"
"<html><head>"
"<meta charset='UTF-8'>"
"<meta name='viewport' content='width=device-width, initial-scale=1.0'>"
"<title>ç”µæœºè°ƒè¯•å·¥å…·</title>"
"<style>"
"body{font-family:Arial,sans-serif;max-width:800px;margin:30px auto;padding:20px;background:linear-gradient(135deg,#ff7e5f 0%,#feb47b 100%)}"
".container{background:white;padding:30px;border-radius:15px;box-shadow:0 8px 32px rgba(0,0,0,0.3)}"
"h1{color:#333;text-align:center;margin-bottom:30px;font-size:28px}"
".debug-section{margin-bottom:25px;padding:20px;border:2px solid #e0e0e0;border-radius:10px;background:#f9f9f9}"
".section-title{font-size:18px;font-weight:bold;color:#333;margin-bottom:15px;display:flex;align-items:center}"
".section-title:before{content:'ğŸ”§';margin-right:8px;font-size:20px}"
".btn-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}"
".btn{background:#4CAF50;color:white;padding:12px 20px;border:none;border-radius:8px;cursor:pointer;font-size:14px;transition:all 0.3s;text-align:center}"
".btn:hover{background:#45a049;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.2)}"
".btn-restart{background:#ff9800}"
".btn-restart:hover{background:#f57c00}"
".btn-query{background:#2196F3}"
".btn-query:hover{background:#1976D2}"
".exception-group{display:flex;align-items:center;gap:10px;margin-bottom:15px}"
"select{padding:8px 12px;border:2px solid #ddd;border-radius:5px;font-size:14px}"
".status{margin-top:20px;padding:15px;border-radius:8px;background:#e8f5e8;border-left:4px solid #4CAF50;font-family:monospace;max-height:200px;overflow-y:auto}"
".nav-link{display:inline-block;margin:10px 0;color:#2196F3;text-decoration:none;font-weight:bold}"
".nav-link:hover{text-decoration:underline}"
"</style>"
"</head><body>"
"<div class='container'>"
"<h1>ğŸ”§ ç”µæœºè°ƒè¯•å·¥å…·</h1>"
"<a href='/' class='nav-link'>â† è¿”å›ä¸»æ§åˆ¶é¡µé¢</a>"

"<div class='debug-section'>"
"<div class='section-title'>ç”µæœºæ§åˆ¶æŒ‡ä»¤</div>"
"<div class='btn-grid'>"
"<button class='btn btn-restart' onclick='restartMotor()'>ğŸ”„ é‡å¯ç”µæœº</button>"
"</div>"
"</div>"

"<div class='debug-section'>"
"<div class='section-title'>ç”µæœºçŠ¶æ€æŸ¥è¯¢</div>"
"<div class='btn-grid'>"
"<button class='btn btn-query' onclick='queryTorque()'>ğŸ’ª æŸ¥è¯¢åŠ›çŸ©</button>"
"<button class='btn btn-query' onclick='queryPower()'>âš¡ æŸ¥è¯¢åŠŸç‡</button>"
"<button class='btn btn-query' onclick='queryEncoder()'>ğŸ”¢ æŸ¥è¯¢ç¼–ç å™¨</button>"
"<button class='btn btn-query' onclick='queryPosSpeed()'>ğŸ“ æŸ¥è¯¢ä½ç½®è½¬é€Ÿ</button>"
"</div>"
"</div>"

"<div class='debug-section'>"
"<div class='section-title'>å¼‚å¸¸çŠ¶æ€æŸ¥è¯¢</div>"
"<div class='exception-group'>"
"<select id='exceptionType'>"
"<option value='0'>ç”µæœºå¼‚å¸¸</option>"
"<option value='1'>ç¼–ç å™¨å¼‚å¸¸</option>"
"<option value='2'>æ§åˆ¶å¼‚å¸¸</option>"
"<option value='3'>ç³»ç»Ÿå¼‚å¸¸</option>"
"<option value='4'>å…¨éƒ¨å¼‚å¸¸</option>"
"</select>"
"<button class='btn btn-query' onclick='queryException()'>âŒ æŸ¥è¯¢å¼‚å¸¸</button>"
"</div>"
"</div>"

"<div class='status' id='debugStatus'>"
"è°ƒè¯•å·¥å…·å°±ç»ªï¼Œç‚¹å‡»æŒ‰é’®å‘é€CANæŒ‡ä»¤æŸ¥è¯¢<br>"
"æ³¨æ„ï¼šæŸ¥è¯¢ç»“æœå°†é€šè¿‡ä¸²å£ç›‘è§†å™¨æ˜¾ç¤ºï¼Œè¯·æŸ¥çœ‹ESP32ä¸²å£è¾“å‡º"
"</div>"
"</div>"

"<script>"
"function restartMotor(){"
"fetch('/debug/restart').then(r=>r.text()).then(d=>{"
"addStatus('é‡å¯ç”µæœºæŒ‡ä»¤å·²å‘é€ | '+d);"
"}).catch(e=>addStatus('é‡å¯å¤±è´¥: '+e));"
"}"
"function queryTorque(){"
"fetch('/debug/query_torque').then(r=>r.text()).then(d=>{"
"addStatus('æŸ¥è¯¢åŠ›çŸ©æŒ‡ä»¤å·²å‘é€ | '+d);"
"}).catch(e=>addStatus('æŸ¥è¯¢å¤±è´¥: '+e));"
"}"
"function queryPower(){"
"fetch('/debug/query_power').then(r=>r.text()).then(d=>{"
"addStatus('æŸ¥è¯¢åŠŸç‡æŒ‡ä»¤å·²å‘é€ | '+d);"
"}).catch(e=>addStatus('æŸ¥è¯¢å¤±è´¥: '+e));"
"}"
"function queryEncoder(){"
"fetch('/debug/query_encoder').then(r=>r.text()).then(d=>{"
"addStatus('æŸ¥è¯¢ç¼–ç å™¨æŒ‡ä»¤å·²å‘é€ | '+d);"
"}).catch(e=>addStatus('æŸ¥è¯¢å¤±è´¥: '+e));"
"}"
"function queryPosSpeed(){"
"fetch('/debug/query_pos_speed').then(r=>r.text()).then(d=>{"
"addStatus('æŸ¥è¯¢ä½ç½®è½¬é€ŸæŒ‡ä»¤å·²å‘é€ | '+d);"
"}).catch(e=>addStatus('æŸ¥è¯¢å¤±è´¥: '+e));"
"}"
"function queryException(){"
"let type=document.getElementById('exceptionType').value;"
"fetch('/debug/query_exception?type='+type).then(r=>r.text()).then(d=>{"
"addStatus('æŸ¥è¯¢å¼‚å¸¸æŒ‡ä»¤å·²å‘é€(ç±»å‹:'+type+') | '+d);"
"}).catch(e=>addStatus('æŸ¥è¯¢å¤±è´¥: '+e));"
"}"
"function addStatus(msg){"
"let status=document.getElementById('debugStatus');"
"let time=new Date().toLocaleTimeString();"
"status.innerHTML+='<br>['+time+'] '+msg;"
"status.scrollTop=status.scrollHeight;"
"}"
"</script>"
"</body></html>";

const char* get_web_page_html(void) {
    return web_page_html;
}

const char* get_debug_page_html(void) {
    return debug_page_html;
}